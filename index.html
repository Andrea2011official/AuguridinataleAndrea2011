<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8">
  <title>Auguri Personalizzati</title>

  <style>
    body {
      font-family: Arial, sans-serif;
      text-align: center;
      margin-top: 40px;
      background: #f0f0f0;
    }

    input {
      font-size: 18px;
      padding: 10px;
      width: 300px;
      border-radius: 6px;
      border: 1px solid #ccc;
    }

    button {
      font-size: 18px;
      padding: 10px 20px;
      margin-left: 10px;
      cursor: pointer;
      border-radius: 6px;
      border: none;
      background: #2c3e50;
      color: white;
    }

    canvas {
      display: block;
      margin: 25px auto;
      border: 1px solid #ccc;
      background: white;
    }

    a#download {
      display: inline-block;
      margin-top: 20px;
      padding: 12px 32px;
      font-size: 18px;
      text-decoration: none;
      border-radius: 30px;
      background: linear-gradient(135deg, #d4af37, #f7e27a);
      color: #3b2f1c;
      font-weight: bold;
      box-shadow: 0 4px 12px rgba(0,0,0,0.25);
      transition: all 0.2s ease;
    }

    a#download:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 16px rgba(0,0,0,0.35);
    }
  </style>
</head>

<body>

  <h2>Inserisci il nome:</h2>

  <input type="text" id="nome" placeholder="Famiglia Rossi">
  <button onclick="genera()">Genera Auguri</button>

  <canvas id="canvas" width="1080" height="1080"></canvas>

  <a id="download" download="auguri.png">Scarica immagine</a>

  <script>
    function genera() {
      const canvas = document.getElementById('canvas');
      const ctx = canvas.getContext('2d');
      const nome = document.getElementById('nome').value || "Famiglia ...";

      const img = new Image();
      img.src = 'base_auguri.png';

      img.onload = function () {
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        ctx.drawImage(img, 0, 0, canvas.width, canvas.height);

        // ===== CONFIGURAZIONE ULTRA PRECISA =====
        const centerX = canvas.width / 2;  // centro targhetta
        const baseY   = canvas.height - 120; // baseline sotto "da"

        ctx.font = '52px Arial';
        ctx.fillStyle = '#000';
        ctx.textBaseline = 'alphabetic';

        // Misura reale del testo
        const metrics = ctx.measureText(nome);
        const textWidth = metrics.width;

        // Calcolo X pixel-perfect
        const drawX = centerX - textWidth / 2;
        const drawY = baseY;

        ctx.fillText(nome, drawX, drawY);

        document.getElementById('download').href =
          canvas.toDataURL('image/png');
      };
    }
  </script>

</body>
</html>
